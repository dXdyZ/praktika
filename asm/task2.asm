section .data
    x dq 5        ; Инициализируем x значением 5
    a dq 3        ; Инициализируем a значением 3

section .text
    global _start

_start:
    ; Загружаем параметры в стек для вызова Padd
    push qword [a]  ; Параметр a
    push qword [x]  ; Параметр x

    ; Вызов процедуры Padd
    call Padd

    ; Получаем результат из стека
    pop rax         ; Извлекаем обновленное значение x из стека (результат)
    pop rdx         ; Убираем a из стека, так как он больше не нужен

    ; Завершаем программу, возвращая результат как код завершения
    mov rdi, rax    ; Код завершения
    mov rax, 60     ; Системный вызов exit
    syscall         ; Вызов завершения программы

Padd:
    ; Сохраняем значение rbp и создаем новый стековый кадр
    push rbp
    mov rbp, rsp

    ; Загружаем параметры x и a из стека
    mov rax, [rbp+16] ; Параметр x
    mov rdx, [rbp+24] ; Параметр a

    ; Выполняем сложение x + a
    add rax, rdx

    ; Записываем результат обратно в стек
    mov [rbp+16], rax

    ; Восстанавливаем старый rbp и возвращаемся
    pop rbp
    ret
